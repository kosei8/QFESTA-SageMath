

# This file was *autogenerated* from the file bench.sage
from sage.all_cmdline import *   # import sage library

_sage_const_2000 = Integer(2000); _sage_const_10 = Integer(10); _sage_const_128 = Integer(128); _sage_const_192 = Integer(192); _sage_const_256 = Integer(256); _sage_const_0 = Integer(0)
import importlib, sys, time
import parameter_generate as param
import elliptic_curve as ec
import QFESTA
import utilities_festa as utilities
importlib.reload(ec)
importlib.reload(param)
importlib.reload(QFESTA)

if __name__ == "__main__":

    utilities.speed_up_sagemath()
    sys.setrecursionlimit(_sage_const_2000 )

    N = _sage_const_10 
    print("using Mumford model")
    for lam in [_sage_const_128 , _sage_const_192 , _sage_const_256 ]:
        KEM = QFESTA.QFESTA_KEM(lam, use_theta=False)

        t_gen = _sage_const_0 
        t_enc = _sage_const_0 
        t_dec = _sage_const_0 
        for _ in range(N):
            t = time.time()
            sec_key, pub_key = KEM.Gen()
            t_gen += time.time() - t
            t = time.time()
            K, ciphertext = KEM.Encaps(pub_key)
            t_enc += time.time() - t
            t = time.time()
            Kd = KEM.Decaps(ciphertext, sec_key, pub_key)
            t_dec += time.time() - t
            assert K == Kd
        print("lam=%d: %.2f, %.2f, %.2f" % (lam, t_gen/N, t_enc/N, t_dec/N))

    print("using theta model")
    for lam in [_sage_const_128 , _sage_const_192 , _sage_const_256 ]:
        KEM = QFESTA.QFESTA_KEM(lam, use_theta=True)

        t_gen = _sage_const_0 
        t_enc = _sage_const_0 
        t_dec = _sage_const_0 
        for _ in range(N):
            t = time.time()
            sec_key, pub_key = KEM.Gen()
            t_gen += time.time() - t
            t = time.time()
            K, ciphertext = KEM.Encaps(pub_key)
            t_enc += time.time() - t
            t = time.time()
            Kd = KEM.Decaps(ciphertext, sec_key, pub_key)
            t_dec += time.time() - t
            assert K == Kd
        print("lam=%d: %.2f, %.2f, %.2f" % (lam, t_gen/N, t_enc/N, t_dec/N))

